%Función de hoja
\newcommand{\hoja}[4]%Cantidad de argumentos
{
	%Contorno
	\draw[pattern=north west lines, pattern color=green!55!black] plot [smooth cycle] coordinates{(#1-#3, #2) (#1 + 0.2*#3, #2 -0.2*#3) (#1 + 2.2*#3, #2 + 1.2*#3) (#1 + 2.9*#3, #2 + 2.7*#3) (#1 + 2.8*#3, #2 + 1.8*#4) (#1 + 2.5*#3, #2 + 2*#4) (#1 + 2.48*#3, #2 + 2.2*#4) (#1 + 2.2*#3, #2 + 2.08*#4) (#1 + 0.7*#3, #2 + 1.9*#4) (#1 - 0.1	*#3, #2 + 3*#3) (#1 - 0.9*#3, #2 + 1.4*#3)};
	\draw[white] plot [smooth cycle] coordinates{(#1-#3, #2) (#1 + 0.2*#3, #2 -0.2*#3) (#1 + 2.2*#3, #2 + 1.2*#3) (#1 + 2.9*#3, #2 + 2.7*#3) (#1 + 2.8*#3, #2 + 1.8*#4) (#1 + 2.5*#3, #2 + 2*#4) (#1 + 2.48*#3, #2 + 2.2*#4) (#1 + 2.2*#3, #2 + 2.08*#4) (#1 + 0.7*#3, #2 + 1.9*#4) (#1 - 0.1	*#3, #2 + 3*#3) (#1 - 0.9*#3, #2 + 1.4*#3)};;
	%Raíz interna
	\draw[white, fill=green!10!white] (#1-1.9*#3, #2-1.5*#3) -- (#1-1.95*#3, #2-1.3*#3) -- (#1-0.2*#3, #2+0.8*#3) -- (#1+0.9*#3, #2+1*#3) -- (#1-0.15*#3, #2+0.9*#3) -- (#1+1.1*#3, #2+2.3*#3) -- (#1+2.1*#3, #2+2.45*#3) -- (#1+1.12*#3, #2+2.4*#3) -- (#1+1.65*#3, #2+3*#3) -- (#1+2.55*#3, #2+3.05*#3) -- (#1+1.7*#3, #2+3.1*#3) -- (#1+2.25*#3, #2+3.7*#3) -- (#1+1.6*#3, #2+3.1*#3) -- (#1+0.7*#3, #2+3.05*#3) -- (#1+1.55*#3, #2+3*#3) -- (#1+0.97*#3, #2+2.4*#3) -- (#1+0.3*#3, #2+2.45*#3) -- (#1+0.9*#3, #2+2.3*#3) -- (#1-0.3*#3, #2+0.9*#3) -- (#1-0.8*#3, #2+1*#3) -- (#1-0.35*#3, #2+0.8*#3) -- (#1-2.1*#3, #2-1.3*#3) -- cycle;
}

\newcommand{\circuloH}[4]
{
	%Círculo
	\hoja{#1}{#2}{#3}{#4};
	\draw[pattern=north west lines, pattern color=green!55!black] (#1 -0.4*#3, #2 + 3*#3) circle (0.9*#3);
	\draw[white] (#1 -0.4*#3, #2 + 3*#3) circle (0.9*#3);
	%Interior
	\draw[white, fill=green!10!white] (#1 - 0.8*#3, #2 + 2.2*#3) -- (#1 +0.2*#3, #2 + 3.65*#3) arc (45:55:0.9*#3) -- (#1 - 0.98*#3, #2 + 2.3*#3) -- cycle;
	%\draw (#1 - 1.08*#3, #2 + 2.4*#3) -- (#1 -0.1*#3, #2 + 3.83*#3);
}

\newcommand{\gota}[4]
{
	\draw[pattern=crosshatch dots, pattern color=blue!30!black] plot [smooth cycle] coordinates{(#1, #2) (#1 + 0.9*#3, #2 + 0.2*#3) (#1 + #3, #2 + #3) (#1, #4) (#1 - #3, #2 + #3) (#1 - 0.9*#3, #2 + 0.2*#3)};
}

\newcommand{\Gota}[4]
{
	\gota{#1}{#2}{#3}{#4};
	\draw[pattern=dots, pattern color=blue!30!white] plot [smooth cycle] coordinates{(#1, #2+0.25*#4) (#1 + 0.45*#3, #2 + 0.2*#3) (#1 + 0.75*#3, #2 + 0.75*#3) (#1, 0.75*#4) (#1 - 0.75*#3, #2 + 0.75*#3) (#1 - 0.45*#3, #2 + 0.2*#3)};
}

\begin{figure}[h!]
	\begin{tikzpicture}
		\circuloH{-4}{0}{0.75}{1.5};
		\node[green!50!black, align=left] at (-5.8,2) {Materia\\ prima};
		\Gota{4}{-0.5}{1.5}{2.75};
		\node[blue!30!black, align=left] at (5.8,2) {Solvente};
		
		%Moléculas
		\draw[fill=red] (-4.7, 2.6) circle (0.08);
		\draw[fill=red] (-4.2, 2.5) circle (0.08);
		\draw[fill=red] (-3.9, 2.2) circle (0.08);
		\draw[fill=red] (-4.3, 2) circle (0.08);
		
		\draw[-triangle 45, fill=black] (-4.5, 3.2) -- (-4.2, 2.5);
		\node[anchor=north, red!50!white] at (-4.5, 3.7) {Producto};
		
		%Flecha solvente
		\coordinate (O) at (4,1);
  		\coordinate (A) at (1,-0.8);

  		\draw (O) to [bend right=15] (A);
  		\draw[-triangle 45, fill=black] (1.01,-0.79) -- (1,-0.8);
  		
  		%Flecha hoja
		\coordinate (OO) at (-3.5,1.5);
  		\coordinate (AA) at (-1,-0.8);

  		\draw (OO) to [bend left=15] (AA);
  		\draw[-triangle 45, fill=black] (-1.01,-0.79) -- (-1,-0.8);

		
		%---Mezcla---
		%vaso
		\draw (-2,-1) -- (-2,-5) -- (-1,-6) -- (1,-6) -- (2,-5) -- (2, -1) -- cycle;
		\node[align=left] at (3.7,-3.2) {Transferencia\\ de masa};
		%Líquido
		\draw[pattern=crosshatch dots, pattern color=blue!30!black] (-1,-6) -- (1,-6) -- (2,-5) -- (2,-3) -- (-2, -3) -- (-2,-5) -- cycle;		
		%Hoja
		\circuloH{-1}{-4.5}{0.25}{0.5}
		\draw[fill=red] (-1.2, -3.7) circle (0.06);
		\draw[fill=red] (-1, -3.75) circle (0.06);
		\draw[fill=red] (-0.7, -4.3) circle (0.06);
		
		\draw[fill=red] (1.2, -4.6) circle (0.06);
		\draw[fill=red] (1.2, -4) circle (0.06);
		
		\draw[white!40!black, -triangle 45, fill=white] (-1, -3.75) -- (1.2, -4);
		\draw[white!40!black, -triangle 45, fill=white] (-0.7, -4.3) -- (1.2, -4.6);
		
		%---Salidas---
		\hoja{-4}{-11}{0.75}{1.5}
		\node[green!50!black, align=left] at (-5.8,-9.5) {Residuo\\ vegetal};
		
		%Flechas
		\coordinate (OOO) at (-0.8,-6.2);
  		\coordinate (AAA) at (-2.1,-7.5);

  		\draw (OOO) to [bend right=15] (AAA);
  		\draw[-triangle 45, fill=black] (-2,-7.3) -- (-2.1,-7.5);
  		
  		\coordinate (OOOO) at (0.8,-6.2);
  		\coordinate (AAAA) at (2.1,-7.5);

  		\draw (OOOO) to [bend left=15] (AAAA);
  		\draw[-triangle 45, fill=black] (2,-7.3) -- (2.1,-7.5);
		
		%Extracto
		\draw[pattern=crosshatch dots, pattern color=blue!30!black] (2,-8) -- (5,-8) -- (5,-11) -- (2,-11) -- cycle;
		\draw[pattern=dots, pattern color=blue!30!white] (2,-8) -- (5,-8) -- (5,-11) -- (2,-11) -- cycle;
		
		\draw[fill=red] (2.5, -8.5) circle (0.08);
		\draw[fill=red] (2.9, -10) circle (0.08);
		\draw[fill=red] (3.5, -9) circle (0.08);
		\draw[fill=red] (4, -10.5) circle (0.08);
		\draw[fill=red] (4.5, -9.5) circle (0.08);
		
		\node[align=left, blue!30!white!50!black] at (6.4,-9.3) {Extracto o\\ aceite esencial};
		
		
	\end{tikzpicture}
	\caption{Extracci\'on.}
	\label{plant_extraction}
\end{figure}